<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medium Prime - Gestão de Funcionários</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .slide-in { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { transform: translateX(-20px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .instagram-gradient { background: linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%); }
        .instagram-gradient-light { background: linear-gradient(45deg, #fdf4f0 0%,#fef1ec 25%,#fdeee8 50%,#fcebe4 75%,#fbe8e0 100%); }
    </style>
</head>
<body class="instagram-gradient-light min-h-screen">
    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="px-6 py-4 border-b">
                <h3 class="text-lg font-semibold text-gray-900">Acesso ao Sistema</h3>
            </div>
            <div class="px-6 py-4 space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Usuário</label>
                    <input type="text" id="loginUsername" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Digite seu usuário">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Senha</label>
                    <input type="password" id="loginPassword" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Digite sua senha">
                </div>
                <div id="loginError" class="text-red-600 text-sm hidden"></div>
            </div>
            <div class="px-6 py-4 border-t flex justify-between">
                <button onclick="loginAsGuest()" class="px-4 py-2 text-gray-600 hover:text-gray-800 font-medium">Acesso Visitante</button>
                <button onclick="performLogin()" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium">Entrar</button>
            </div>
        </div>
    </div>
    <!-- Header -->
    <header class="bg-white shadow-lg border-b-4 instagram-gradient">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="instagram-gradient p-3 rounded-lg">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">Medium Prime</h1>
                        <p class="text-sm text-gray-600">Prestação de Serviços, Lda</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div id="userInfo" class="text-sm text-gray-600"></div>
                    <button id="exportBtn" onclick="exportToCSV()" class="instagram-gradient hover:opacity-90 text-white px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center space-x-2 shadow-lg">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        <span>Exportar CSV</span>
                    </button>
                    <button id="addEmployeeBtn" onclick="showAddEmployeeModal()" class="instagram-gradient hover:opacity-90 text-white px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center space-x-2 shadow-lg">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                        </svg>
                        <span>Adicionar Funcionário</span>
                    </button>
                    <button id="loginLogoutBtn" onclick="handleLoginLogout()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 flex items-center space-x-2">
                        <svg id="loginLogoutIcon" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m0 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path>
                        </svg>
                        <span id="loginLogoutText">Entrar</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex space-x-8">
                <button onclick="showTab('ativos')" id="tab-ativos" class="tab-button border-b-2 border-pink-500 text-pink-600 py-4 px-1 font-medium">
                    Funcionários Ativos
                </button>
                <button onclick="showTab('ferias')" id="tab-ferias" class="tab-button border-b-2 border-transparent text-gray-500 hover:text-pink-600 py-4 px-1 font-medium">
                    Em Férias
                </button>
                <button onclick="showTab('geral')" id="tab-geral" class="tab-button border-b-2 border-transparent text-gray-500 hover:text-pink-600 py-4 px-1 font-medium">
                    Lista Geral
                </button>
                <button onclick="showTab('subsidios')" id="tab-subsidios" class="tab-button border-b-2 border-transparent text-gray-500 hover:text-pink-600 py-4 px-1 font-medium">
                    Subsídios
                </button>
                <button onclick="showTab('presencas')" id="tab-presencas" class="tab-button border-b-2 border-transparent text-gray-500 hover:text-pink-600 py-4 px-1 font-medium">
                    Faltas & Presenças
                </button>
                <button onclick="showTab('servicos')" id="tab-servicos" class="tab-button border-b-2 border-transparent text-gray-500 hover:text-pink-600 py-4 px-1 font-medium">
                    Nossos Serviços
                </button>
                <button onclick="showTab('galeria')" id="tab-galeria" class="tab-button border-b-2 border-transparent text-gray-500 hover:text-pink-600 py-4 px-1 font-medium">
                    Galeria de Serviços
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Search and Filter Bar -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <div class="flex flex-col sm:flex-row gap-4 items-center justify-between">
                <div class="flex-1 max-w-md">
                    <div class="relative">
                        <input type="text" id="searchInput" placeholder="Pesquisar funcionários..." 
                               class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500"
                               oninput="filterEmployees()">
                        <svg class="absolute left-3 top-2.5 h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                    </div>
                </div>
                <div class="flex gap-2">
                    <select id="sortSelect" onchange="sortEmployees()" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500">
                        <option value="nome">Ordenar por Nome</option>
                        <option value="cargo">Ordenar por Cargo</option>
                        <option value="desempenho">Ordenar por Desempenho</option>
                        <option value="salario">Ordenar por Salário</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Guest Access Notice -->
        <div id="guestNotice" class="bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-6 hidden">
            <div class="flex items-start space-x-3">
                <svg class="w-6 h-6 text-yellow-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                </svg>
                <div class="flex-1">
                    <h3 class="text-lg font-semibold text-yellow-800 mb-2">Acesso Limitado - Visitante</h3>
                    <p class="text-yellow-700 mb-3">Você está visualizando o sistema como visitante. Para obter acesso completo ou solicitar credenciais de administrador, entre em contato conosco:</p>
                    <div class="space-y-2">
                        <div class="flex items-center space-x-2">
                            <svg class="w-4 h-4 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                            <span class="text-yellow-700">Av. Pedro de Castro Van Dunen Loy, Travessa B1, Casa nº 3</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <svg class="w-4 h-4 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                            </svg>
                            <a href="https://wa.me/244925010623" target="_blank" class="text-yellow-700 hover:text-yellow-800 underline">+244 925 010 623</a> / +244 952 627 955
                        </div>
                        <div class="flex items-center space-x-2">
                            <svg class="w-4 h-4 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                            </svg>
                            <a href="mailto:mediumtravelexpress@gmail.com" class="text-yellow-700 hover:text-yellow-800 underline">mediumtravelexpress@gmail.com</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Content -->
        <div id="content-ativos" class="tab-content">
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <div class="px-6 py-4 bg-green-50 border-b">
                    <h2 class="text-xl font-semibold text-green-800 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        Funcionários Ativos
                    </h2>
                </div>
                <div id="activeEmployeesList" class="divide-y divide-gray-200"></div>
            </div>
        </div>

        <div id="content-ferias" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <div class="px-6 py-4 bg-orange-50 border-b">
                    <h2 class="text-xl font-semibold text-orange-800 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                        </svg>
                        Funcionários em Férias
                    </h2>
                </div>
                <div id="vacationEmployeesList" class="divide-y divide-gray-200"></div>
            </div>
        </div>

        <div id="content-geral" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <div class="px-6 py-4 bg-blue-50 border-b">
                    <h2 class="text-xl font-semibold text-blue-800 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                        </svg>
                        Lista Geral de Funcionários
                    </h2>
                </div>
                <div id="allEmployeesList" class="divide-y divide-gray-200"></div>
            </div>
        </div>

        <div id="content-subsidios" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                        </svg>
                        Gestão de Subsídios
                    </h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Selecionar Funcionário</label>
                            <select id="subsidyEmployeeSelect" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">Escolher funcionário...</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Subsídio</label>
                            <select id="subsidyTypeSelect" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="ferias">Subsídio de Férias</option>
                                <option value="alimentacao">Subsídio de Alimentação</option>
                                <option value="transporte">Subsídio de Transporte</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Valor (Kz)</label>
                            <input type="number" id="subsidyAmount" placeholder="0.00" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="flex gap-2">
                            <button onclick="applySubsidy()" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg font-medium transition-colors">
                                Aplicar Subsídio
                            </button>
                            <button onclick="removeSubsidy()" class="flex-1 bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-lg font-medium transition-colors">
                                Remover Subsídio
                            </button>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Subsídios Ativos</h3>
                    <div id="activeSubsidiesList" class="space-y-3"></div>
                </div>
            </div>
        </div>

        <div id="content-presencas" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                        Registrar Presença/Falta
                    </h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Funcionário</label>
                            <select id="attendanceEmployeeSelect" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">Escolher funcionário...</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Data</label>
                            <input type="date" id="attendanceDate" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tipo</label>
                            <select id="attendanceType" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="presente">Presente</option>
                                <option value="falta">Falta</option>
                                <option value="falta-justificada">Falta Justificada</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Observações</label>
                            <textarea id="attendanceNotes" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Observações opcionais..."></textarea>
                        </div>
                        <button onclick="recordAttendance()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg font-medium transition-colors">
                            Registrar
                        </button>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Histórico de Presenças</h3>
                    <div class="mb-4">
                        <select id="attendanceHistoryEmployee" onchange="loadAttendanceHistory()" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Ver histórico de...</option>
                        </select>
                    </div>
                    <div id="attendanceHistoryList" class="space-y-2 max-h-96 overflow-y-auto"></div>
                </div>
            </div>
        </div>

        <div id="content-servicos" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <div class="px-6 py-4 instagram-gradient text-white">
                    <h2 class="text-2xl font-bold flex items-center">
                        <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                        </svg>
                        Medium Prime - Nossos Serviços
                    </h2>
                    <p class="text-pink-100 mt-2">Sua agência de viagens completa em Angola</p>
                </div>
                
                <div class="p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Serviços de Transporte -->
                    <div class="bg-gradient-to-br from-pink-50 to-orange-50 rounded-lg p-6 border border-pink-200">
                        <div class="flex items-center mb-4">
                            <div class="instagram-gradient p-3 rounded-lg mr-3">
                                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12l6-6m-6 6l6 6"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-bold text-pink-800">✈️ Serviços de Transporte</h3>
                        </div>
                        <ul class="space-y-2 text-sm text-pink-700">
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-pink-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Venda de passagens aéreas (domésticas e internacionais)
                            </li>
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-pink-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Reserva de passagens de ônibus, trem e cruzeiros
                            </li>
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-pink-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Transfers (traslados de/para aeroporto, hotel, passeios)
                            </li>
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-pink-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Aluguel de carros
                            </li>
                        </ul>
                    </div>

                    <!-- Hospedagem e Pacotes -->
                    <div class="bg-gradient-to-br from-orange-50 to-red-50 rounded-lg p-6 border border-orange-200">
                        <div class="flex items-center mb-4">
                            <div class="instagram-gradient p-3 rounded-lg mr-3">
                                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-bold text-orange-800">🏨 Hospedagem e Pacotes</h3>
                        </div>
                        <ul class="space-y-2 text-sm text-orange-700">
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-orange-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Reservas de hotéis, resorts, pousadas, hostels
                            </li>
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-orange-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Pacotes turísticos completos (transporte + hospedagem + passeios)
                            </li>
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-orange-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Viagens sob medida (roteiros personalizados para grupos, famílias ou empresas)
                            </li>
                        </ul>
                    </div>

                    <!-- Passeios e Experiências -->
                    <div class="bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg p-6 border border-purple-200">
                        <div class="flex items-center mb-4">
                            <div class="instagram-gradient p-3 rounded-lg mr-3">
                                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-bold text-purple-800">🎟️ Passeios e Experiências</h3>
                        </div>
                        <ul class="space-y-2 text-sm text-purple-700">
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-purple-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Organização de tours guiados em cidades, praias, destinos culturais e naturais
                            </li>
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-purple-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Ingressos para atrações turísticas, parques temáticos, shows e eventos
                            </li>
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-purple-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Pacotes de aventura (trilhas, safáris, esportes radicais, mergulho, etc)
                            </li>
                        </ul>
                    </div>

                    <!-- Documentação e Suporte -->
                    <div class="bg-gradient-to-br from-yellow-50 to-orange-50 rounded-lg p-6 border border-yellow-200">
                        <div class="flex items-center mb-4">
                            <div class="instagram-gradient p-3 rounded-lg mr-3">
                                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-bold text-yellow-800">📄 Documentação e Suporte</h3>
                        </div>
                        <ul class="space-y-2 text-sm text-yellow-700">
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-yellow-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Assessoria para vistos e documentação de viagem
                            </li>
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-yellow-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Contratação de seguros de viagem (saúde, bagagem, cancelamento)
                            </li>
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-yellow-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Suporte em casos de alteração de voos, extravio de bagagem ou emergências
                            </li>
                        </ul>
                    </div>

                    <!-- Serviços Corporativos -->
                    <div class="bg-gradient-to-br from-red-50 to-pink-50 rounded-lg p-6 border border-red-200">
                        <div class="flex items-center mb-4">
                            <div class="instagram-gradient p-3 rounded-lg mr-3">
                                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-bold text-red-800">💼 Serviços Corporativos</h3>
                        </div>
                        <ul class="space-y-2 text-sm text-red-700">
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-red-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Organização de viagens de negócios (bilhetes, hotéis, transporte)
                            </li>
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-red-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Gestão de eventos, congressos, feiras, incentivos e convenções (MICE)
                            </li>
                        </ul>
                    </div>

                    <!-- Consultoria e Conveniência -->
                    <div class="bg-gradient-to-br from-indigo-50 to-purple-50 rounded-lg p-6 border border-indigo-200">
                        <div class="flex items-center mb-4">
                            <div class="instagram-gradient p-3 rounded-lg mr-3">
                                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-bold text-indigo-800">💡 Consultoria e Conveniência</h3>
                        </div>
                        <ul class="space-y-2 text-sm text-indigo-700">
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-indigo-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Orientação sobre roteiros turísticos, melhores épocas para viajar e dicas locais
                            </li>
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-indigo-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Conversão de moeda estrangeira (ou indicação de casas de câmbio parceiras)
                            </li>
                            <li class="flex items-start">
                                <span class="w-2 h-2 bg-indigo-500 rounded-full mt-2 mr-2 flex-shrink-0"></span>
                                Programas de fidelidade e milhas
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Contact Section -->
                <div class="instagram-gradient text-white p-6">
                    <div class="text-center">
                        <h3 class="text-xl font-bold mb-4">Entre em Contato Conosco</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                            <div class="flex items-center justify-center space-x-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                </svg>
                                <span>Av. Pedro de Castro Van Dunen Loy, Travessa B1, Casa nº 3</span>
                            </div>
                            <div class="flex items-center justify-center space-x-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                                </svg>
                                <a href="https://wa.me/244925010623" target="_blank" class="hover:underline">+244 925 010 623</a> / +244 952 627 955
                            </div>
                            <div class="flex items-center justify-center space-x-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                                </svg>
                                <a href="mailto:mediumtravelexpress@gmail.com" class="hover:underline">mediumtravelexpress@gmail.com</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="content-galeria" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <div class="px-6 py-4 instagram-gradient text-white flex justify-between items-center">
                    <div>
                        <h2 class="text-2xl font-bold flex items-center">
                            <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                            Galeria de Serviços
                        </h2>
                        <p class="text-pink-100 mt-1">Compartilhe e explore nossos serviços</p>
                    </div>
                    <button id="addPostBtn" onclick="showAddPostModal()" class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center space-x-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                        </svg>
                        <span>Nova Publicação</span>
                    </button>
                </div>
                
                <div class="p-6">
                    <div id="postsContainer" class="space-y-6"></div>
                    <div id="noPostsMessage" class="text-center py-12 text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                        <p class="text-lg font-medium mb-2">Nenhuma publicação ainda</p>
                        <p>Seja o primeiro a compartilhar um serviço!</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Add Post Modal -->
    <div id="postModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b">
                <h3 class="text-lg font-semibold text-gray-900">Nova Publicação</h3>
            </div>
            <div class="px-6 py-4 space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Foto do Serviço</label>
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                        <input type="file" id="postImage" accept="image/*" class="hidden" onchange="previewPostImage()">
                        <div id="postImagePreview" class="mb-4">
                            <svg class="w-12 h-12 mx-auto text-gray-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                            <p class="text-gray-500">Clique para adicionar uma foto</p>
                        </div>
                        <button type="button" onclick="document.getElementById('postImage').click()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium">
                            Escolher Foto
                        </button>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Título do Serviço</label>
                    <input type="text" id="postTitle" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Ex: Pacote Turístico para Benguela" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Descrição</label>
                    <textarea id="postDescription" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Descreva os detalhes do serviço..." required></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Categoria</label>
                    <select id="postCategory" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <option value="transporte">Transporte</option>
                        <option value="hospedagem">Hospedagem</option>
                        <option value="passeios">Passeios</option>
                        <option value="documentacao">Documentação</option>
                        <option value="corporativo">Corporativo</option>
                        <option value="consultoria">Consultoria</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Preço (opcional)</label>
                    <input type="text" id="postPrice" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Ex: A partir de Kz 150.000">
                </div>
            </div>
            <div class="px-6 py-4 border-t flex justify-end space-x-3">
                <button onclick="hidePostModal()" class="px-4 py-2 text-gray-600 hover:text-gray-800 font-medium">Cancelar</button>
                <button onclick="savePost()" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium">Publicar</button>
            </div>
        </div>
    </div>

    <!-- Add/Edit Employee Modal -->
    <div id="employeeModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b">
                <h3 id="modalTitle" class="text-lg font-semibold text-gray-900">Adicionar Funcionário</h3>
            </div>
            <div class="px-6 py-4 space-y-4">
                <input type="hidden" id="editEmployeeId">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Foto de Perfil</label>
                    <div class="flex items-center space-x-4">
                        <div id="photoPreview" class="w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden">
                            <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                        </div>
                        <input type="file" id="employeePhoto" accept="image/*" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" onchange="previewPhoto()">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Nome Completo</label>
                    <input type="text" id="employeeName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Cargo</label>
                    <input type="text" id="employeePosition" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Salário (Kz)</label>
                    <input type="number" id="employeeSalary" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <input type="email" id="employeeEmail" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Telefone</label>
                    <input type="tel" id="employeePhone" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Pontuação de Desempenho (0-100)</label>
                    <input type="number" id="employeePerformance" min="0" max="100" value="75" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                </div>
            </div>
            <div class="px-6 py-4 border-t flex justify-end space-x-3">
                <button onclick="hideEmployeeModal()" class="px-4 py-2 text-gray-600 hover:text-gray-800 font-medium">Cancelar</button>
                <button onclick="saveEmployee()" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium">Salvar</button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let employees = [];
        let currentTab = 'ativos';
        let filteredEmployees = [];
        let currentUser = null;
        let userRole = null;

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadSampleData();
            loadEmployees();
            loadPosts();
            
            // Auto-login as visitor - no credentials needed for viewing
            currentUser = 'visitor';
            userRole = 'visitor';
            updateUIForRole();
            updateLoginButton();
            
            showTab('ativos');
            updateEmployeeSelects();
            
            // Set today's date as default
            document.getElementById('attendanceDate').value = new Date().toISOString().split('T')[0];
            
            // Add enter key listener for login
            document.getElementById('loginPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performLogin();
                }
            });
        });

        // Authentication functions
        function showLoginModal() {
            document.getElementById('loginModal').classList.remove('hidden');
        }

        function hideLoginModal() {
            document.getElementById('loginModal').classList.add('hidden');
        }

        function performLogin() {
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value.trim();
            const errorDiv = document.getElementById('loginError');
            
            // Clear previous errors
            errorDiv.classList.add('hidden');
            errorDiv.textContent = '';
            
            if (!username || !password) {
                showLoginError('Por favor, preencha todos os campos.');
                return;
            }
            
            // Check credentials
            if (username === 'Luzolo' && password === '5280582') {
                currentUser = 'authenticated';
                userRole = 'admin';
            } else if (username === 'user' && password === '123456') {
                currentUser = 'authenticated';
                userRole = 'user';
            } else {
                showLoginError('Credenciais inválidas. Tente novamente.');
                return;
            }
            
            hideLoginModal();
            updateUIForRole();
            updateLoginButton();
        }

        function loginAsGuest() {
            currentUser = 'guest';
            userRole = 'guest';
            
            // Don't save guest login to localStorage
            hideLoginModal();
            updateUIForRole();
            updateLoginButton();
        }

        function logout() {
            // Return to visitor mode instead of showing login modal
            currentUser = 'visitor';
            userRole = 'visitor';
            
            // Clear form
            document.getElementById('loginUsername').value = '';
            document.getElementById('loginPassword').value = '';
            
            updateUIForRole();
            updateLoginButton();
        }

        function showLoginError(message) {
            const errorDiv = document.getElementById('loginError');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
        }

        function updateUIForRole() {
            const userInfo = document.getElementById('userInfo');
            const guestNotice = document.getElementById('guestNotice');
            const exportBtn = document.getElementById('exportBtn');
            const addEmployeeBtn = document.getElementById('addEmployeeBtn');
            const addPostBtn = document.getElementById('addPostBtn');
            
            // Update user info display
            if (currentUser === 'authenticated' && userRole === 'admin') {
                userInfo.textContent = 'Administrador';
                userInfo.className = 'text-sm text-green-600 font-medium';
            } else if (currentUser === 'authenticated' && userRole === 'user') {
                userInfo.textContent = 'Usuário';
                userInfo.className = 'text-sm text-blue-600 font-medium';
            } else if (userRole === 'visitor') {
                userInfo.textContent = 'Visitante';
                userInfo.className = 'text-sm text-blue-600 font-medium';
            } else if (userRole === 'guest') {
                userInfo.textContent = 'Convidado';
                userInfo.className = 'text-sm text-yellow-600 font-medium';
            } else {
                userInfo.textContent = 'Visualização';
                userInfo.className = 'text-sm text-gray-600 font-medium';
            }
            
            // Show/hide guest notice - only for explicit guest login
            if (userRole === 'guest') {
                guestNotice.classList.remove('hidden');
            } else {
                guestNotice.classList.add('hidden');
            }
            
            // Control button visibility and functionality
            if (currentUser === 'authenticated') {
                // Authenticated users have full access
                exportBtn.style.display = 'flex';
                addEmployeeBtn.style.display = 'flex';
                addPostBtn.style.display = 'flex';
                enableAllTabs();
            } else {
                // Visitors and guests can only view - no management buttons
                exportBtn.style.display = 'none';
                addEmployeeBtn.style.display = 'none';
                addPostBtn.style.display = 'none';
                enableAllTabs(); // Can view all tabs
            }
            
            renderEmployeeList();
            renderPosts();
        }

        function enableAllTabs() {
            // Enable all tabs for logged-in users
            document.querySelectorAll('.tab-button').forEach(button => {
                button.style.pointerEvents = 'auto';
                button.style.opacity = '1';
            });
        }

        function disableEditingFeatures() {
            // Disable editing features for guests
            enableAllTabs(); // Guests can still view all tabs
        }

        // Sample data
        function loadSampleData() {
            const sampleEmployees = [
                {
                    id: 1,
                    nome: 'Ana Silva',
                    cargo: 'Gestora de Projetos',
                    salario: 850000.00,
                    email: 'ana.silva@mediumprime.ao',
                    telefone: '+244 912 345 678',
                    desempenho: 92,
                    status: 'ativo',
                    subsidios: {
                        ferias: 170000.00,
                        alimentacao: 50000.00,
                        transporte: 0
                    }
                },
                {
                    id: 2,
                    nome: 'João Santos',
                    cargo: 'Desenvolvedor Senior',
                    salario: 750000.00,
                    email: 'joao.santos@mediumprime.ao',
                    telefone: '+244 913 456 789',
                    desempenho: 88,
                    status: 'ativo',
                    subsidios: {
                        ferias: 150000.00,
                        alimentacao: 50000.00,
                        transporte: 35000.00
                    }
                },
                {
                    id: 3,
                    nome: 'Maria Costa',
                    cargo: 'Designer UX/UI',
                    salario: 620000.00,
                    email: 'maria.costa@mediumprime.ao',
                    telefone: '+244 914 567 890',
                    desempenho: 95,
                    status: 'ferias',
                    subsidios: {
                        ferias: 124000.00,
                        alimentacao: 50000.00,
                        transporte: 28000.00
                    }
                },
                {
                    id: 4,
                    nome: 'Pedro Oliveira',
                    cargo: 'Analista de Sistemas',
                    salario: 680000.00,
                    email: 'pedro.oliveira@mediumprime.ao',
                    telefone: '+244 915 678 901',
                    desempenho: 78,
                    status: 'ativo',
                    subsidios: {
                        ferias: 136000.00,
                        alimentacao: 50000.00,
                        transporte: 0
                    }
                },
                {
                    id: 5,
                    nome: 'Sofia Ferreira',
                    cargo: 'Contabilista',
                    salario: 580000.00,
                    email: 'sofia.ferreira@mediumprime.ao',
                    telefone: '+244 916 789 012',
                    desempenho: 85,
                    status: 'ferias',
                    subsidios: {
                        ferias: 116000.00,
                        alimentacao: 50000.00,
                        transporte: 22000.00
                    }
                }
            ];

            if (!localStorage.getItem('mediumPrimeEmployees')) {
                localStorage.setItem('mediumPrimeEmployees', JSON.stringify(sampleEmployees));
            }

            // Sample attendance data
            const sampleAttendance = [
                { employeeId: 1, date: '2024-01-15', type: 'presente', notes: '' },
                { employeeId: 1, date: '2024-01-16', type: 'presente', notes: '' },
                { employeeId: 1, date: '2024-01-17', type: 'falta-justificada', notes: 'Consulta médica' },
                { employeeId: 2, date: '2024-01-15', type: 'presente', notes: '' },
                { employeeId: 2, date: '2024-01-16', type: 'falta', notes: '' },
                { employeeId: 3, date: '2024-01-15', type: 'presente', notes: '' }
            ];

            if (!localStorage.getItem('mediumPrimeAttendance')) {
                localStorage.setItem('mediumPrimeAttendance', JSON.stringify(sampleAttendance));
            }
        }

        // Load employees from localStorage
        function loadEmployees() {
            const stored = localStorage.getItem('mediumPrimeEmployees');
            employees = stored ? JSON.parse(stored) : [];
            filteredEmployees = [...employees];
        }

        // Save employees to localStorage
        function saveEmployees() {
            localStorage.setItem('mediumPrimeEmployees', JSON.stringify(employees));
        }

        // Tab management
        function showTab(tabName) {
            currentTab = tabName;
            
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Remove active state from all tabs
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('border-pink-500', 'text-pink-600');
                button.classList.add('border-transparent', 'text-gray-500');
            });
            
            // Show selected tab content
            document.getElementById(`content-${tabName}`).classList.remove('hidden');
            
            // Add active state to selected tab
            const activeTab = document.getElementById(`tab-${tabName}`);
            activeTab.classList.remove('border-transparent', 'text-gray-500');
            activeTab.classList.add('border-pink-500', 'text-pink-600');
            
            // Render appropriate content
            renderEmployeeList();
            updateEmployeeSelects();
        }

        // Render employee list based on current tab
        function renderEmployeeList() {
            let targetEmployees = [];
            let containerId = '';
            
            switch(currentTab) {
                case 'ativos':
                    targetEmployees = filteredEmployees.filter(emp => emp.status === 'ativo');
                    containerId = 'activeEmployeesList';
                    break;
                case 'ferias':
                    targetEmployees = filteredEmployees.filter(emp => emp.status === 'ferias');
                    containerId = 'vacationEmployeesList';
                    break;
                case 'geral':
                    targetEmployees = filteredEmployees;
                    containerId = 'allEmployeesList';
                    break;
                default:
                    return;
            }
            
            const container = document.getElementById(containerId);
            
            if (targetEmployees.length === 0) {
                container.innerHTML = `
                    <div class="p-8 text-center text-gray-500">
                        <svg class="w-12 h-12 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                        </svg>
                        <p>Nenhum funcionário encontrado</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = targetEmployees.map(employee => `
                <div class="p-6 hover:bg-gray-50 transition-colors fade-in">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <div class="flex items-center space-x-4">
                                <div class="flex-shrink-0">
                                    <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-lg overflow-hidden">
                                        ${employee.photo ? `<img src="${employee.photo}" alt="${employee.nome}" class="w-full h-full object-cover">` : employee.nome.split(' ').map(n => n[0]).join('').substring(0, 2)}
                                    </div>
                                </div>
                                <div class="flex-1">
                                    <h3 class="text-lg font-semibold text-gray-900">${employee.nome}</h3>
                                    <p class="text-sm text-gray-600">${employee.cargo}</p>
                                    <div class="flex items-center space-x-4 mt-2">
                                        <span class="text-sm text-gray-500">Kz ${employee.salario.toLocaleString('pt-AO')}</span>
                                        <div class="flex items-center space-x-1">
                                            <span class="text-sm text-gray-500">Desempenho:</span>
                                            <div class="w-16 bg-gray-200 rounded-full h-2">
                                                <div class="bg-gradient-to-r from-green-400 to-green-600 h-2 rounded-full" style="width: ${employee.desempenho}%"></div>
                                            </div>
                                            <span class="text-sm font-medium text-gray-700">${employee.desempenho}%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="px-3 py-1 text-xs font-medium rounded-full ${employee.status === 'ativo' ? 'bg-green-100 text-green-800' : 'bg-orange-100 text-orange-800'}">
                                ${employee.status === 'ativo' ? 'Ativo' : 'Em Férias'}
                            </span>
                            ${currentUser === 'authenticated' ? `
                            <button onclick="toggleEmployeeStatus(${employee.id})" class="p-2 text-gray-400 hover:text-blue-600 transition-colors" title="${employee.status === 'ativo' ? 'Marcar como em férias' : 'Marcar como ativo'}">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                                </svg>
                            </button>
                            <button onclick="editEmployee(${employee.id})" class="p-2 text-gray-400 hover:text-blue-600 transition-colors" title="Editar funcionário">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                </svg>
                            </button>
                            <button onclick="deleteEmployee(${employee.id})" class="p-2 text-gray-400 hover:text-red-600 transition-colors" title="Eliminar funcionário">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                            ` : `
                            <button onclick="showLoginForManagement()" class="p-2 text-gray-300 hover:text-blue-500 transition-colors" title="Fazer login para gerenciar">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                                </svg>
                            </button>
                            `}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Filter employees
        function filterEmployees() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            filteredEmployees = employees.filter(employee => 
                employee.nome.toLowerCase().includes(searchTerm) ||
                employee.cargo.toLowerCase().includes(searchTerm) ||
                employee.email.toLowerCase().includes(searchTerm)
            );
            renderEmployeeList();
        }

        // Sort employees
        function sortEmployees() {
            const sortBy = document.getElementById('sortSelect').value;
            filteredEmployees.sort((a, b) => {
                switch(sortBy) {
                    case 'nome':
                        return a.nome.localeCompare(b.nome);
                    case 'cargo':
                        return a.cargo.localeCompare(b.cargo);
                    case 'desempenho':
                        return b.desempenho - a.desempenho;
                    case 'salario':
                        return b.salario - a.salario;
                    default:
                        return 0;
                }
            });
            renderEmployeeList();
        }

        // Employee modal functions
        function previewPhoto() {
            const fileInput = document.getElementById('employeePhoto');
            const preview = document.getElementById('photoPreview');
            
            if (fileInput.files && fileInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.innerHTML = `<img src="${e.target.result}" alt="Preview" class="w-full h-full object-cover rounded-full">`;
                };
                reader.readAsDataURL(fileInput.files[0]);
            }
        }

        function requireLogin(action) {
            if (currentUser !== 'authenticated') {
                showLoginModal();
                return false;
            }
            return true;
        }

        function showLoginForManagement() {
            showLoginModal();
        }

        function handleLoginLogout() {
            if (currentUser === 'authenticated') {
                logout();
            } else {
                showLoginModal();
            }
        }

        function updateLoginButton() {
            const loginLogoutBtn = document.getElementById('loginLogoutBtn');
            const loginLogoutIcon = document.getElementById('loginLogoutIcon');
            const loginLogoutText = document.getElementById('loginLogoutText');
            
            if (currentUser === 'authenticated') {
                loginLogoutText.textContent = 'Sair';
                loginLogoutIcon.innerHTML = `
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                `;
            } else {
                loginLogoutText.textContent = 'Entrar';
                loginLogoutIcon.innerHTML = `
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m0 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path>
                `;
            }
        }

        function showAddEmployeeModal() {
            if (!requireLogin('add_employee')) return;
            document.getElementById('modalTitle').textContent = 'Adicionar Funcionário';
            document.getElementById('editEmployeeId').value = '';
            document.getElementById('employeeName').value = '';
            document.getElementById('employeePosition').value = '';
            document.getElementById('employeeSalary').value = '';
            document.getElementById('employeeEmail').value = '';
            document.getElementById('employeePhone').value = '';
            document.getElementById('employeePerformance').value = '75';
            document.getElementById('employeePhoto').value = '';
            document.getElementById('photoPreview').innerHTML = `
                <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                </svg>
            `;
            document.getElementById('employeeModal').classList.remove('hidden');
            document.getElementById('employeeModal').classList.add('flex');
        }

        function hideEmployeeModal() {
            document.getElementById('employeeModal').classList.add('hidden');
            document.getElementById('employeeModal').classList.remove('flex');
        }

        function editEmployee(id) {
            const employee = employees.find(emp => emp.id === id);
            if (!employee) return;
            
            document.getElementById('modalTitle').textContent = 'Editar Funcionário';
            document.getElementById('editEmployeeId').value = employee.id;
            document.getElementById('employeeName').value = employee.nome;
            document.getElementById('employeePosition').value = employee.cargo;
            document.getElementById('employeeSalary').value = employee.salario;
            document.getElementById('employeeEmail').value = employee.email || '';
            document.getElementById('employeePhone').value = employee.telefone || '';
            document.getElementById('employeePerformance').value = employee.desempenho;
            document.getElementById('employeePhoto').value = '';
            
            // Show existing photo if available
            const preview = document.getElementById('photoPreview');
            if (employee.photo) {
                preview.innerHTML = `<img src="${employee.photo}" alt="${employee.nome}" class="w-full h-full object-cover rounded-full">`;
            } else {
                preview.innerHTML = `
                    <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                `;
            }
            
            document.getElementById('employeeModal').classList.remove('hidden');
            document.getElementById('employeeModal').classList.add('flex');
        }

        function saveEmployee() {
            const id = document.getElementById('editEmployeeId').value;
            const nome = document.getElementById('employeeName').value.trim();
            const cargo = document.getElementById('employeePosition').value.trim();
            const salario = parseFloat(document.getElementById('employeeSalary').value);
            const email = document.getElementById('employeeEmail').value.trim();
            const telefone = document.getElementById('employeePhone').value.trim();
            const desempenho = parseInt(document.getElementById('employeePerformance').value);
            const photoFile = document.getElementById('employeePhoto').files[0];
            
            if (!nome || !cargo || !salario) {
                alert('Por favor, preencha todos os campos obrigatórios.');
                return;
            }
            
            // Handle photo upload
            const processEmployee = (photoData = null) => {
                if (id) {
                    // Edit existing employee
                    const employeeIndex = employees.findIndex(emp => emp.id === parseInt(id));
                    if (employeeIndex !== -1) {
                        employees[employeeIndex] = {
                            ...employees[employeeIndex],
                            nome,
                            cargo,
                            salario,
                            email,
                            telefone,
                            desempenho,
                            photo: photoData || employees[employeeIndex].photo
                        };
                    }
                } else {
                    // Add new employee
                    const newEmployee = {
                        id: Date.now(),
                        nome,
                        cargo,
                        salario,
                        email,
                        telefone,
                        desempenho,
                        status: 'ativo',
                        photo: photoData,
                        subsidios: {
                            ferias: 0,
                            alimentacao: 0,
                            transporte: 0
                        }
                    };
                    employees.push(newEmployee);
                }
                
                saveEmployees();
                loadEmployees();
                renderEmployeeList();
                updateEmployeeSelects();
                hideEmployeeModal();
            };
            
            // If photo is selected, convert to base64
            if (photoFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    processEmployee(e.target.result);
                };
                reader.readAsDataURL(photoFile);
            } else {
                processEmployee();
            }
        }

        function deleteEmployee(id) {
            if (confirm('Tem certeza que deseja eliminar este funcionário?')) {
                employees = employees.filter(emp => emp.id !== id);
                saveEmployees();
                loadEmployees();
                renderEmployeeList();
                updateEmployeeSelects();
            }
        }

        function toggleEmployeeStatus(id) {
            const employee = employees.find(emp => emp.id === id);
            if (employee) {
                employee.status = employee.status === 'ativo' ? 'ferias' : 'ativo';
                saveEmployees();
                loadEmployees();
                renderEmployeeList();
            }
        }

        // Update employee select dropdowns
        function updateEmployeeSelects() {
            const selects = ['subsidyEmployeeSelect', 'attendanceEmployeeSelect', 'attendanceHistoryEmployee'];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                const currentValue = select.value;
                
                select.innerHTML = '<option value="">Escolher funcionário...</option>';
                employees.forEach(employee => {
                    const option = document.createElement('option');
                    option.value = employee.id;
                    option.textContent = employee.nome;
                    select.appendChild(option);
                });
                
                select.value = currentValue;
            });
            
            updateActiveSubsidies();
        }

        // Subsidy management
        function applySubsidy() {
            if (!requireLogin('apply_subsidy')) return;
            
            const employeeId = parseInt(document.getElementById('subsidyEmployeeSelect').value);
            const subsidyType = document.getElementById('subsidyTypeSelect').value;
            const amount = parseFloat(document.getElementById('subsidyAmount').value);
            
            if (!employeeId || !amount) {
                alert('Por favor, selecione um funcionário e insira um valor.');
                return;
            }
            
            const employee = employees.find(emp => emp.id === employeeId);
            if (employee) {
                if (!employee.subsidios) {
                    employee.subsidios = { ferias: 0, alimentacao: 0, transporte: 0 };
                }
                employee.subsidios[subsidyType] = amount;
                saveEmployees();
                updateActiveSubsidies();
                document.getElementById('subsidyAmount').value = '';
                alert('Subsídio aplicado com sucesso!');
            }
        }

        function removeSubsidy() {
            if (!requireLogin('remove_subsidy')) return;
            
            const employeeId = parseInt(document.getElementById('subsidyEmployeeSelect').value);
            const subsidyType = document.getElementById('subsidyTypeSelect').value;
            
            if (!employeeId) {
                alert('Por favor, selecione um funcionário.');
                return;
            }
            
            const employee = employees.find(emp => emp.id === employeeId);
            if (employee && employee.subsidios) {
                employee.subsidios[subsidyType] = 0;
                saveEmployees();
                updateActiveSubsidies();
                alert('Subsídio removido com sucesso!');
            }
        }

        function updateActiveSubsidies() {
            const container = document.getElementById('activeSubsidiesList');
            const subsidies = [];
            
            employees.forEach(employee => {
                if (employee.subsidios) {
                    Object.entries(employee.subsidios).forEach(([type, amount]) => {
                        if (amount > 0) {
                            subsidies.push({
                                employeeName: employee.nome,
                                type: type,
                                amount: amount
                            });
                        }
                    });
                }
            });
            
            if (subsidies.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center">Nenhum subsídio ativo</p>';
                return;
            }
            
            const typeNames = {
                ferias: 'Férias',
                alimentacao: 'Alimentação',
                transporte: 'Transporte'
            };
            
            container.innerHTML = subsidies.map(subsidy => `
                <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                    <div>
                        <p class="font-medium text-gray-900">${subsidy.employeeName}</p>
                        <p class="text-sm text-gray-600">Subsídio de ${typeNames[subsidy.type]}</p>
                    </div>
                    <span class="font-semibold text-green-600">Kz ${subsidy.amount.toLocaleString('pt-AO')}</span>
                </div>
            `).join('');
        }

        // Attendance management
        function recordAttendance() {
            if (!requireLogin('record_attendance')) return;
            
            const employeeId = parseInt(document.getElementById('attendanceEmployeeSelect').value);
            const date = document.getElementById('attendanceDate').value;
            const type = document.getElementById('attendanceType').value;
            const notes = document.getElementById('attendanceNotes').value.trim();
            
            if (!employeeId || !date) {
                alert('Por favor, selecione um funcionário e uma data.');
                return;
            }
            
            const attendance = JSON.parse(localStorage.getItem('mediumPrimeAttendance') || '[]');
            
            // Remove existing record for same employee and date
            const filteredAttendance = attendance.filter(record => 
                !(record.employeeId === employeeId && record.date === date)
            );
            
            // Add new record
            filteredAttendance.push({
                employeeId,
                date,
                type,
                notes
            });
            
            localStorage.setItem('mediumPrimeAttendance', JSON.stringify(filteredAttendance));
            
            // Clear form
            document.getElementById('attendanceEmployeeSelect').value = '';
            document.getElementById('attendanceDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('attendanceType').value = 'presente';
            document.getElementById('attendanceNotes').value = '';
            
            alert('Presença registrada com sucesso!');
            loadAttendanceHistory();
        }

        function loadAttendanceHistory() {
            const employeeId = parseInt(document.getElementById('attendanceHistoryEmployee').value);
            const container = document.getElementById('attendanceHistoryList');
            
            if (!employeeId) {
                container.innerHTML = '<p class="text-gray-500 text-center">Selecione um funcionário</p>';
                return;
            }
            
            const attendance = JSON.parse(localStorage.getItem('mediumPrimeAttendance') || '[]');
            const employeeAttendance = attendance
                .filter(record => record.employeeId === employeeId)
                .sort((a, b) => new Date(b.date) - new Date(a.date));
            
            if (employeeAttendance.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center">Nenhum registro encontrado</p>';
                return;
            }
            
            const typeNames = {
                presente: 'Presente',
                falta: 'Falta',
                'falta-justificada': 'Falta Justificada'
            };
            
            const typeColors = {
                presente: 'bg-green-100 text-green-800',
                falta: 'bg-red-100 text-red-800',
                'falta-justificada': 'bg-yellow-100 text-yellow-800'
            };
            
            container.innerHTML = employeeAttendance.map(record => `
                <div class="flex justify-between items-center p-3 bg-white border rounded-lg">
                    <div>
                        <p class="font-medium text-gray-900">${new Date(record.date).toLocaleDateString('pt-PT')}</p>
                        ${record.notes ? `<p class="text-sm text-gray-600">${record.notes}</p>` : ''}
                    </div>
                    <span class="px-2 py-1 text-xs font-medium rounded-full ${typeColors[record.type]}">
                        ${typeNames[record.type]}
                    </span>
                </div>
            `).join('');
        }

        // Export to CSV
        function exportToCSV() {
            const csvContent = [
                ['Nome', 'Cargo', 'Salário (Kz)', 'Email', 'Telefone', 'Desempenho', 'Status', 'Subsídio Férias (Kz)', 'Subsídio Alimentação (Kz)', 'Subsídio Transporte (Kz)'],
                ...employees.map(emp => [
                    emp.nome,
                    emp.cargo,
                    emp.salario,
                    emp.email || '',
                    emp.telefone || '',
                    emp.desempenho,
                    emp.status,
                    emp.subsidios?.ferias || 0,
                    emp.subsidios?.alimentacao || 0,
                    emp.subsidios?.transporte || 0
                ])
            ].map(row => row.join(',')).join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `funcionarios_medium_prime_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Gallery functions
        let posts = [];

        function loadPosts() {
            const stored = localStorage.getItem('mediumPrimePosts');
            posts = stored ? JSON.parse(stored) : [];
            renderPosts();
        }

        function savePosts() {
            localStorage.setItem('mediumPrimePosts', JSON.stringify(posts));
        }

        function showAddPostModal() {
            if (!requireLogin('add_post')) return;
            document.getElementById('postModal').classList.remove('hidden');
            document.getElementById('postModal').classList.add('flex');
        }

        function hidePostModal() {
            document.getElementById('postModal').classList.add('hidden');
            document.getElementById('postModal').classList.remove('flex');
            // Clear form
            document.getElementById('postTitle').value = '';
            document.getElementById('postDescription').value = '';
            document.getElementById('postPrice').value = '';
            document.getElementById('postImage').value = '';
            document.getElementById('postImagePreview').innerHTML = `
                <svg class="w-12 h-12 mx-auto text-gray-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                </svg>
                <p class="text-gray-500">Clique para adicionar uma foto</p>
            `;
        }

        function previewPostImage() {
            const fileInput = document.getElementById('postImage');
            const preview = document.getElementById('postImagePreview');
            
            if (fileInput.files && fileInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.innerHTML = `<img src="${e.target.result}" alt="Preview" class="max-w-full h-32 object-cover rounded-lg mx-auto">`;
                };
                reader.readAsDataURL(fileInput.files[0]);
            }
        }

        function savePost() {
            const title = document.getElementById('postTitle').value.trim();
            const description = document.getElementById('postDescription').value.trim();
            const category = document.getElementById('postCategory').value;
            const price = document.getElementById('postPrice').value.trim();
            const imageFile = document.getElementById('postImage').files[0];
            
            if (!title || !description) {
                alert('Por favor, preencha o título e a descrição.');
                return;
            }
            
            const processPost = (imageData = null) => {
                const newPost = {
                    id: Date.now(),
                    title,
                    description,
                    category,
                    price,
                    image: imageData,
                    author: currentUser,
                    date: new Date().toISOString(),
                    likes: 0,
                    likedBy: [],
                    comments: []
                };
                
                posts.unshift(newPost);
                savePosts();
                renderPosts();
                hidePostModal();
            };
            
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    processPost(e.target.result);
                };
                reader.readAsDataURL(imageFile);
            } else {
                processPost();
            }
        }

        function renderPosts() {
            const container = document.getElementById('postsContainer');
            const noPostsMessage = document.getElementById('noPostsMessage');
            
            if (posts.length === 0) {
                container.innerHTML = '';
                noPostsMessage.style.display = 'block';
                return;
            }
            
            noPostsMessage.style.display = 'none';
            
            const categoryIcons = {
                transporte: '✈️',
                hospedagem: '🏨',
                passeios: '🎟️',
                documentacao: '📄',
                corporativo: '💼',
                consultoria: '💡'
            };
            
            container.innerHTML = posts.map(post => `
                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                    <div class="p-4 border-b">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 instagram-gradient rounded-full flex items-center justify-center text-white font-semibold">
                                    MP
                                </div>
                                <div>
                                    <p class="font-semibold text-gray-900">Medium Prime</p>
                                    <p class="text-sm text-gray-500">${new Date(post.date).toLocaleDateString('pt-PT')}</p>
                                </div>
                            </div>
                            <span class="px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded-full">
                                ${categoryIcons[post.category]} ${post.category.charAt(0).toUpperCase() + post.category.slice(1)}
                            </span>
                        </div>
                    </div>
                    
                    ${post.image ? `
                    <div class="aspect-w-16 aspect-h-9">
                        <img src="${post.image}" alt="${post.title}" class="w-full h-64 object-cover">
                    </div>
                    ` : ''}
                    
                    <div class="p-4">
                        <h3 class="text-lg font-semibold text-gray-900 mb-2">${post.title}</h3>
                        <p class="text-gray-700 mb-3">${post.description}</p>
                        ${post.price ? `<p class="text-sm font-medium text-green-600 mb-3">${post.price}</p>` : ''}
                        
                        <div class="flex items-center justify-between pt-3 border-t">
                            <div class="flex items-center space-x-4">
                                <button onclick="toggleLike(${post.id})" class="flex items-center space-x-1 text-gray-500 hover:text-red-500 transition-colors ${post.likedBy.includes(currentUser) ? 'text-red-500' : ''}">
                                    <svg class="w-5 h-5 ${post.likedBy.includes(currentUser) ? 'fill-current' : ''}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                                    </svg>
                                    <span>${post.likes}</span>
                                </button>
                                <button onclick="toggleComments(${post.id})" class="flex items-center space-x-1 text-gray-500 hover:text-blue-500 transition-colors">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                                    </svg>
                                    <span>${post.comments.length}</span>
                                </button>
                            </div>
                            ${currentUser === 'authenticated' ? `
                            <button onclick="deletePost(${post.id})" class="flex items-center space-x-1 px-3 py-1 text-red-600 hover:bg-red-50 rounded-lg transition-colors text-sm font-medium">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                                <span>Apagar</span>
                            </button>
                            ` : ''}
                        </div>
                        
                        <div id="comments-${post.id}" class="hidden mt-4 pt-4 border-t">
                            <div class="space-y-3 mb-4">
                                ${post.comments.map(comment => `
                                    <div class="flex space-x-3">
                                        <div class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center text-xs font-semibold">
                                            ${comment.author.charAt(0).toUpperCase()}
                                        </div>
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-gray-900">${comment.author}</p>
                                            <p class="text-sm text-gray-700">${comment.text}</p>
                                            <p class="text-xs text-gray-500 mt-1">${new Date(comment.date).toLocaleDateString('pt-PT')}</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                            <div class="flex space-x-2">
                                <input type="text" id="comment-input-${post.id}" placeholder="Escreva um comentário..." class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500">
                                <button onclick="addComment(${post.id})" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium">
                                    Comentar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function toggleLike(postId) {
            const post = posts.find(p => p.id === postId);
            if (!post) return;
            
            const userIndex = post.likedBy.indexOf(currentUser);
            if (userIndex > -1) {
                post.likedBy.splice(userIndex, 1);
                post.likes--;
            } else {
                post.likedBy.push(currentUser);
                post.likes++;
            }
            
            savePosts();
            renderPosts();
        }

        function toggleComments(postId) {
            const commentsDiv = document.getElementById(`comments-${postId}`);
            commentsDiv.classList.toggle('hidden');
        }

        function addComment(postId) {
            const input = document.getElementById(`comment-input-${postId}`);
            const text = input.value.trim();
            
            if (!text) return;
            
            const post = posts.find(p => p.id === postId);
            if (!post) return;
            
            const comment = {
                id: Date.now(),
                author: currentUser === 'admin' ? 'Medium Prime' : currentUser,
                text,
                date: new Date().toISOString()
            };
            
            post.comments.push(comment);
            savePosts();
            renderPosts();
            
            // Keep comments open and clear input
            setTimeout(() => {
                document.getElementById(`comments-${postId}`).classList.remove('hidden');
                document.getElementById(`comment-input-${postId}`).value = '';
            }, 100);
        }

        function deletePost(postId) {
            if (confirm('Tem certeza que deseja eliminar esta publicação?')) {
                posts = posts.filter(p => p.id !== postId);
                savePosts();
                renderPosts();
            }
        }

        // Close modal when clicking outside
        document.getElementById('employeeModal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideEmployeeModal();
            }
        });

        document.getElementById('postModal').addEventListener('click', function(e) {
            if (e.target === this) {
                hidePostModal();
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97f8056e21b777dd',t:'MTc1NzkzODIyOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
